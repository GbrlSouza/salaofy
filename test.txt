

/*

$pageTitle = "Dashboard do Morador | Salaofy"; 

require 'inc/header.php'; 

$perfil_morador_id = 3; 

if (!isset($_SESSION['usuario']) || $_SESSION['usuario']['id_perfil'] != $perfil_morador_id) {
    if (isset($_SESSION['usuario'])) {
        $perfil_id = $_SESSION['usuario']['id_perfil'];
        if ($perfil_id == 1) { header('Location: admin.php'); exit; }
        if ($perfil_id == 2) { header('Location: sindico.php'); exit; }
    }
}

$nome_display = $_SESSION['usuario']['nome_completo'] ?? 'Visitante';
$id_usuario = $_SESSION['usuario']['id_usuario'] ?? 0;

?>

    <section id="overview" class="mb-5 p-4 bg-white rounded shadow-sm">
        <h1 class="mb-4 text-primary"><i class="bi bi-house-door-fill me-2"></i> Dashboard</h1>
        <p class="lead">Bem-vindo, **<?php echo htmlspecialchars($nome_display); ?>**! Visão geral do seu condomínio.</p>

        <div class="row g-4">
            <div class="col-lg-4 col-md-6">
                <div class="card bg-success text-white">
                    <div class="card-body">
                        <h5 class="card-title">Próxima Reserva</h5>
                        <p class="card-text fs-3 fw-bold">Salão Principal</p>
                        <p class="card-text">20/07/2025 (Confirmada)</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="card bg-warning text-dark">
                    <div class="card-body">
                        <h5 class="card-title">Suas Pendências</h5>
                        <p class="card-text fs-3 fw-bold">1</p>
                        <p class="card-text">Reserva aguardando aprovação.</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-12">
                <div class="card bg-info text-white">
                    <div class="card-body">
                        <h5 class="card-title">Salões Livres Hoje</h5>
                        <p class="card-text fs-3 fw-bold">2 de 3</p>
                        <p class="card-text">Verifique a agenda completa.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="reservas" class="mb-5 p-4 bg-white rounded shadow">
        <h2 class="mb-4 text-primary"><i class="bi bi-calendar-check me-2"></i> Minhas Reservas</h2>
        
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Salão</th>
                        <th>Data</th>
                        <th>Status</th>
                        <th>Valor</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <?php 
                    if (!empty($minhasReservas)) {
                        foreach ($minhasReservas as $reserva) {
                            echo "<tr>";
                            echo "<td>" . htmlspecialchars($reserva['nome_salao']) . "</td>";
                            echo "<td>" . date('d/m/Y', strtotime($reserva['data_evento'])) . "</td>";
                            // Lógica para badge de status...
                            echo "<td><span class='badge bg-success'>" . $reserva['status'] . "</span></td>";
                            echo "<td>R$ " . number_format($reserva['valor_total'], 2, ',', '.') . "</td>";
                            echo "<td><button class='btn btn-sm btn-outline-info'>Detalhes</button></td>";
                            echo "</tr>";
                        }
                    } else { echo "<tr><td colspan='5' class='text-center'>Você não tem reservas ativas.</td></tr>"; }
                    ?>
                    <tr>
                        <td>Salão Principal</td>
                        <td>20/07/2025</td>
                        <td><span class="badge bg-success">Confirmada</span></td>
                        <td>R$ 350,00</td>
                        <td>
                            <button class="btn btn-sm btn-outline-info"><i class="bi bi-eye"></i> Detalhes</button>
                        </td>
                    </tr>
                    <tr>
                        <td>Espaço Gourmet</td>
                        <td>05/08/2025</td>
                        <td><span class="badge bg-warning text-dark">Pendente</span></td>
                        <td>R$ 250,00</td>
                        <td>
                            <button class="btn btn-sm btn-outline-danger"><i class="bi bi-x-circle"></i> Cancelar</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <section id="agendar" class="mb-5 p-4 bg-light rounded shadow-sm">
        <h2 class="mb-4 text-primary"><i class="bi bi-plus-square me-2"></i> Agendar Novo Salão</h2>
        
        <form action="processa_agendamento.php" method="POST">
            <div class="row g-3">
                <div class="col-md-6">
                    <label for="salaoSelect" class="form-label">Escolha o Salão</label>
                    <select id="salaoSelect" name="id_salao" class="form-select" required>
                        <option value="">Selecione...</option>
                        <option value="1">Salão Principal (R$ 350,00)</option>
                        <option value="2">Churrasqueira 1 (R$ 100,00)</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label for="dataAgenda" class="form-label">Data Desejada</label>
                    <input type="date" class="form-control" id="dataAgenda" name="data_evento" required>
                </div>
                <div class="col-12">
                    <label for="detalhes" class="form-label">Detalhes do Evento (Opcional)</label>
                    <textarea class="form-control" id="detalhes" name="detalhes_evento" rows="2"></textarea>
                </div>
                <div class="col-12">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="1" id="aceiteRegras" required>
                        <label class="form-check-label" for="aceiteRegras">
                            Li e aceito as <a href="#saloes">Regras de Uso</a> do salão.
                        </label>
                    </div>
                </div>
                <div class="col-12">
                    <button type="submit" class="btn btn-primary btn-lg"><i class="bi bi-send me-2"></i> Enviar Solicitação</button>
                </div>
            </div>
        </form>
    </section>
    
    <section id="saloes" class="mb-5 p-4 bg-white rounded shadow">
        <h2 class="mb-4 text-primary"><i class="bi bi-info-circle me-2"></i> Regras e Detalhes dos Salões</h2>
        <p>Conteúdo dinâmico das regras...</p>
    </section>

<?php require 'inc/footer.php'; ?>